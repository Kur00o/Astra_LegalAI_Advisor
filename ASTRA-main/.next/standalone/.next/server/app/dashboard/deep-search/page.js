(()=>{var e={};e.id=63,e.ids=[63],e.modules={643:e=>{"use strict";e.exports=require("node:perf_hooks")},1708:e=>{"use strict";e.exports=require("node:process")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},4573:e=>{"use strict";e.exports=require("node:buffer")},7252:e=>{"use strict";e.exports=require("express")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},12412:e=>{"use strict";e.exports=require("assert")},14975:(e,r,t)=>{"use strict";t.d(r,{A:()=>s});let s=(0,t(82614).A)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},14985:e=>{"use strict";e.exports=require("dns")},16141:e=>{"use strict";e.exports=require("node:zlib")},16698:e=>{"use strict";e.exports=require("node:async_hooks")},17366:(e,r,t)=>{"use strict";t.r(r),t.d(r,{"402ea164051600561a5b96dcb300dd162d6ffd0a36":()=>u});var s=t(91199);t(42087);var a=t(95427),i=t(37612);let o={groq:process.env.GROQ_API_KEY,together:process.env.TOGETHER_AI_API_KEY,huggingface:process.env.HUGGINGFACE_API_KEY,deepseek:process.env.DEEPSEEK_API_KEY,cerebras:process.env.CEREBRAS_API_KEY,bing:process.env.BING_SEARCH_API_KEY,brave:process.env.BRAVE_SEARCH_API_KEY,gemini:process.env.GEMINI_API_KEY};var n=t(33331);let l=i.z.object({query:i.z.string().describe("The legal query or topic to search for clauses about."),jurisdiction:i.z.string().describe("The legal jurisdiction to consider for the search."),documentDataUri:i.z.string().optional().describe("An optional document or image file for context, as a data URI that must include a MIME type and use Base64 encoding. Expected format: 'data:<mimetype>;base64,<encoded_data>'.")}),d=i.z.object({clauseText:i.z.string().describe("The exact text of the related legal clause found online."),sourceTitle:i.z.string().describe("The title of the source website or document."),sourceUrl:i.z.string().describe("The URL where the clause was found."),relevance:i.z.string().describe("A brief explanation of how this clause relates to the user's query or document context.")}),c=i.z.object({relatedClauses:i.z.array(d).describe("A list of relevant legal clauses discovered from the web search.")});async function u(e){return m(e)}async function p(e,r){let t=o.brave;if(!t)throw Error("BRAVE_SEARCH_API_KEY is not set in environment variables.");let s=`${e} legal clause in ${r}`,a=await fetch(`https://api.search.brave.com/res/v1/web/search?q=${encodeURIComponent(s)}`,{headers:{Accept:"application/json","X-Subscription-Token":t}});if(!a.ok)throw Error(`Brave Search API request failed with status ${a.status}`);let i=await a.json();return(i.web?.results||[]).map(e=>({title:e.title,url:e.url,snippet:e.description}))}let h=a.ai.definePrompt({name:"deepSearchClauseAnalysisPrompt",input:{schema:i.z.object({query:i.z.string(),jurisdiction:i.z.string(),documentContext:i.z.string().optional(),searchResults:i.z.string()})},output:{schema:c},prompt:`You are a highly efficient legal research AI. Your task is to analyze the provided web search results and extract relevant legal clauses based on the user's query and a specific legal jurisdiction.

    Jurisdiction for this search: "{{jurisdiction}}"
    User's Query: "{{query}}"
    
    {{#if documentContext}}
    The user has also provided the following document for additional context. Use it to inform the relevance of the clauses you find.
    Context: {{media url=documentContext}}
    {{/if}}

    Analyze the search results below. For each relevant result, you must:
    1. Extract the specific legal clause text.
    2. Identify the source title and URL.
    3. Provide a brief explanation of its relevance to the user's query, considering the laws of "{{jurisdiction}}".
    
    Return a list of these clauses. Focus on accuracy and relevance. Do not summarize; extract the clauses directly.

    Search Results:
    {{{searchResults}}}
    `}),m=a.ai.defineFlow({name:"deepSearchFlow",inputSchema:l,outputSchema:c},async e=>{let r=(await p(e.query,e.jurisdiction)).slice(0,5)||[];if(0===r.length)return{relatedClauses:[]};let{output:t}=await h({query:e.query,jurisdiction:e.jurisdiction,documentContext:e.documentDataUri,searchResults:JSON.stringify(r,null,2)});return t?{relatedClauses:(t.relatedClauses||[]).filter(e=>e.sourceUrl&&e.clauseText)}:{relatedClauses:[]}});(0,n.D)([u]),(0,s.A)(u,"402ea164051600561a5b96dcb300dd162d6ffd0a36",null)},19063:e=>{"use strict";e.exports=require("require-in-the-middle")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},19185:e=>{"use strict";e.exports=require("dgram")},19771:e=>{"use strict";e.exports=require("process")},21820:e=>{"use strict";e.exports=require("os")},22327:e=>{"use strict";e.exports=require("node:https")},27910:e=>{"use strict";e.exports=require("stream")},28354:e=>{"use strict";e.exports=require("util")},29021:e=>{"use strict";e.exports=require("fs")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},29674:(e,r,t)=>{"use strict";t.r(r),t.d(r,{GlobalError:()=>o.a,__next_app__:()=>u,pages:()=>c,routeModule:()=>p,tree:()=>d});var s=t(65239),a=t(48088),i=t(88170),o=t.n(i),n=t(30893),l={};for(let e in n)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>n[e]);t.d(r,l);let d={children:["",{children:["dashboard",{children:["deep-search",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,62281)),"/home/user/ASTRA/ASTRA-main/src/app/dashboard/deep-search/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,63144)),"/home/user/ASTRA/ASTRA-main/src/app/dashboard/layout.tsx"],metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(t.bind(t,94431)),"/home/user/ASTRA/ASTRA-main/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(t.t.bind(t,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(t.t.bind(t,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,c=["/home/user/ASTRA/ASTRA-main/src/app/dashboard/deep-search/page.tsx"],u={require:t,loadChunk:()=>Promise.resolve()},p=new s.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/dashboard/deep-search/page",pathname:"/dashboard/deep-search",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},32363:(e,r,t)=>{Promise.resolve().then(t.bind(t,42606))},33873:e=>{"use strict";e.exports=require("path")},34631:e=>{"use strict";e.exports=require("tls")},36644:(e,r,t)=>{"use strict";t.d(r,{A:()=>s});let s=(0,t(82614).A)("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]])},37067:e=>{"use strict";e.exports=require("node:http")},37830:e=>{"use strict";e.exports=require("node:stream/web")},42606:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>w});var s=t(60687),a=t(43210),i=t(72624),o=t(29523),n=t(44493),l=t(89667),d=t(6475);let c=(0,d.createServerReference)("402ea164051600561a5b96dcb300dd162d6ffd0a36",d.callServer,void 0,d.findSourceMapURL,"deepSearch");var u=t(41936),p=t(82614);let h=(0,p.A)("FileUp",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"m15 15-3-3-3 3",key:"15xj92"}]]);var m=t(82850),x=t(78726),f=t(11516);let g=(0,p.A)("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);var v=t(36644),b=t(85814),y=t.n(b),j=t(30474),A=t(91821),q=t(14975);function w(){let[e,r]=(0,a.useState)(""),[t,d]=(0,a.useState)(!1),[p,b]=(0,a.useState)(null),[w,N]=(0,a.useState)(null),[_,k]=(0,a.useState)(null),[R,S]=(0,a.useState)(null),[P,E]=(0,a.useState)(null),T=async(r,t,s)=>{let a=s||P;if(!a)return void N("Please select a jurisdiction first from the main page.");let i="string"==typeof r?r:e,o=t||R;if(!i.trim()&&!o)return void N("A search query or a file is required to perform a DeepSearch.");d(!0),b(null),N(null);try{let e=await c({query:i.trim()||"Analyze the provided document.",jurisdiction:a.name,documentDataUri:o||void 0});b(e)}catch(e){N("DeepSearch failed. Please check your API keys and try again."),console.error(e)}finally{d(!1)}},z=(0,a.useCallback)(r=>{let t=r[0];if(t){k(t);let r=new FileReader;r.onloadend=()=>{let t=r.result;S(t),T(e,t,P)},r.readAsDataURL(t)}},[e,P]),{getRootProps:C,getInputProps:I,isDragActive:M}=(0,i.VB)({onDrop:z,accept:{"image/*":[".jpeg",".png",".gif",".webp"],"text/plain":[".txt"],"application/pdf":[".pdf"]}});return(0,s.jsx)("main",{className:"flex flex-col h-full bg-secondary p-4 md:p-8",children:(0,s.jsxs)(n.Zp,{className:"w-full max-w-4xl mx-auto shadow-lg",children:[(0,s.jsxs)(n.aR,{children:[(0,s.jsxs)(n.ZB,{className:"font-serif text-2xl flex items-center gap-3",children:[(0,s.jsx)(u.A,{className:"h-6 w-6"}),"Intelligent DeepSearch"]}),(0,s.jsx)(n.BT,{children:"Find relevant legal clauses from across the web. Upload a document for context or enter a query to begin."})]}),(0,s.jsxs)(n.Wu,{children:[(0,s.jsxs)("div",{className:"flex flex-col gap-4 mb-6",children:[(0,s.jsxs)("div",{...C(),className:`flex flex-col items-center justify-center p-6 border-2 border-dashed rounded-lg cursor-pointer transition-colors ${M?"border-primary bg-primary/5":"border-border hover:border-primary/50"}`,children:[(0,s.jsx)("input",{...I()}),(0,s.jsx)(h,{className:"h-10 w-10 text-muted-foreground mb-2"}),(0,s.jsx)("p",{className:"text-muted-foreground text-sm",children:"Drag & drop a file to automatically analyze, or enter a query below."}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Images, PDF, or .txt files supported"})]}),R&&(0,s.jsxs)("div",{className:"relative p-2 border rounded-lg flex items-center gap-3",children:[_?.type.startsWith("image/")?(0,s.jsx)(j.default,{src:R,alt:"Preview",width:48,height:48,className:"rounded-md object-cover"}):(0,s.jsx)(m.A,{className:"h-8 w-8 text-muted-foreground"}),(0,s.jsxs)("div",{className:"text-sm",children:[(0,s.jsx)("p",{className:"font-medium",children:_?.name}),(0,s.jsxs)("p",{className:"text-muted-foreground text-xs",children:[Math.round((_?.size||0)/1024)," KB"]})]}),(0,s.jsx)(o.$,{variant:"ghost",size:"icon",className:"absolute top-1 right-1 h-6 w-6",onClick:()=>{k(null),S(null),N(null)},children:(0,s.jsx)(x.A,{className:"h-4 w-4"})})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(l.p,{type:"text",placeholder:"Enter a legal topic to find related clauses...",value:e,onChange:e=>r(e.target.value),onKeyDown:e=>"Enter"===e.key&&T(),className:"text-base"}),(0,s.jsxs)(o.$,{onClick:()=>T(),disabled:t,size:"lg",children:[t?(0,s.jsx)(f.A,{className:"h-5 w-5 animate-spin"}):(0,s.jsx)(u.A,{className:"h-5 w-5"}),(0,s.jsx)("span",{className:"ml-2 hidden md:inline",children:"Search"})]})]})]}),w&&(0,s.jsxs)(A.Fc,{variant:"destructive",children:[(0,s.jsx)(q.A,{className:"h-4 w-4"}),(0,s.jsx)(A.XL,{children:"Error"}),(0,s.jsx)(A.TN,{children:w})]}),t&&(0,s.jsxs)("div",{className:"text-center text-muted-foreground py-10 flex flex-col items-center gap-4",children:[(0,s.jsx)(f.A,{className:"h-10 w-10 animate-spin text-primary"}),(0,s.jsx)("p",{className:"font-serif",children:"Performing DeepSearch for related clauses..."})]}),p&&(0,s.jsxs)("div",{className:"space-y-6 mt-6",children:[(0,s.jsx)("h3",{className:"font-semibold text-xl mb-2 font-serif",children:"Discovered Clauses"}),p.relatedClauses.length>0?(0,s.jsx)("div",{className:"space-y-4",children:p.relatedClauses.map((e,r)=>(0,s.jsxs)(n.Zp,{className:"p-4 bg-secondary",children:[(0,s.jsx)("blockquote",{className:"border-l-4 border-primary pl-4 mb-3",children:(0,s.jsxs)("p",{className:"text-sm italic",children:['"',e.clauseText,'"']})}),(0,s.jsxs)("p",{className:"text-xs text-muted-foreground mb-3",children:[(0,s.jsx)("strong",{className:"text-foreground font-medium",children:"Relevance:"})," ",e.relevance]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 text-xs",children:[(0,s.jsx)(g,{className:"h-3 w-3 text-primary"}),(0,s.jsx)(y(),{href:e.sourceUrl,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline font-medium truncate",children:e.sourceTitle})]})]},r))}):(0,s.jsxs)("div",{className:"text-center text-muted-foreground py-10 flex flex-col items-center gap-4",children:[(0,s.jsx)(v.A,{className:"h-10 w-10 text-primary/50"}),(0,s.jsx)("p",{className:"font-serif",children:"No relevant clauses found."}),(0,s.jsx)("p",{className:"text-sm",children:"Try refining your search query or uploading a different document."})]})]})]})]})})}},54379:e=>{"use strict";e.exports=require("node:path")},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},56801:e=>{"use strict";e.exports=require("import-in-the-middle")},57075:e=>{"use strict";e.exports=require("node:stream")},57975:e=>{"use strict";e.exports=require("node:util")},62281:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>s});let s=(0,t(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/home/user/ASTRA/ASTRA-main/src/app/dashboard/deep-search/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/home/user/ASTRA/ASTRA-main/src/app/dashboard/deep-search/page.tsx","default")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},73024:e=>{"use strict";e.exports=require("node:fs")},73136:e=>{"use strict";e.exports=require("node:url")},73496:e=>{"use strict";e.exports=require("http2")},73566:e=>{"use strict";e.exports=require("worker_threads")},74075:e=>{"use strict";e.exports=require("zlib")},74998:e=>{"use strict";e.exports=require("perf_hooks")},77030:e=>{"use strict";e.exports=require("node:net")},77598:e=>{"use strict";e.exports=require("node:crypto")},79428:e=>{"use strict";e.exports=require("buffer")},79551:e=>{"use strict";e.exports=require("url")},79646:e=>{"use strict";e.exports=require("child_process")},79748:e=>{"use strict";e.exports=require("fs/promises")},81630:e=>{"use strict";e.exports=require("http")},84297:e=>{"use strict";e.exports=require("async_hooks")},89667:(e,r,t)=>{"use strict";t.d(r,{p:()=>o});var s=t(60687),a=t(43210),i=t(4780);let o=a.forwardRef(({className:e,type:r,...t},a)=>(0,s.jsx)("input",{type:r,className:(0,i.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:a,...t}));o.displayName="Input"},91645:e=>{"use strict";e.exports=require("net")},91821:(e,r,t)=>{"use strict";t.d(r,{Fc:()=>l,TN:()=>c,XL:()=>d});var s=t(60687),a=t(43210),i=t(24224),o=t(4780);let n=(0,i.F)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),l=a.forwardRef(({className:e,variant:r,...t},a)=>(0,s.jsx)("div",{ref:a,role:"alert",className:(0,o.cn)(n({variant:r}),e),...t}));l.displayName="Alert";let d=a.forwardRef(({className:e,...r},t)=>(0,s.jsx)("h5",{ref:t,className:(0,o.cn)("mb-1 font-medium leading-none tracking-tight",e),...r}));d.displayName="AlertTitle";let c=a.forwardRef(({className:e,...r},t)=>(0,s.jsx)("div",{ref:t,className:(0,o.cn)("text-sm [&_p]:leading-relaxed",e),...r}));c.displayName="AlertDescription"},94735:e=>{"use strict";e.exports=require("events")},95411:(e,r,t)=>{Promise.resolve().then(t.bind(t,62281))}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[447,94,567,64,509,474,572,448],()=>t(29674));module.exports=s})();